<html>
<head><meta charset="utf-8">
<title>Riff Lightning Diffusion</title>
</head>
<body>
    <h1>Riff Lightning Diffusion</h1>
    <label for="prompt">Prompt:</label>
    <textarea id="prompt" rows="10" cols="80"></textarea>    
    <button id="generate">Generate</button>
    <div id="output"></div>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.9.1/underscore-min.js"></script>
    <script>
        var defaultPrompt = "photo of a unicorn";
        // override default prompt with URL parameter
        var urlParams = new URLSearchParams(window.location.search);
        if (urlParams.has('prompt')) {
            defaultPrompt = urlParams.get('prompt');
        }
        $("#prompt").val(defaultPrompt);

        var n = 3;
        if (urlParams.has('n')) {
            n = urlParams.get('n');
        }
        var steps = 25;
        if (urlParams.has('steps')) {
            steps = urlParams.get('steps');
        }
        var strength = 0.8;
        if (urlParams.has('strength')) {
            strength = urlParams.get('strength');
        }
        var seed = 1512;
        if (urlParams.has('seed')) {
            seed = urlParams.get('seed');
        }

        var onClickFn =function() {
            var prompt = $('#prompt').val();
            $('#output').html('');
            var iframeHref = '/rendermany?prompt=' + encodeURIComponent(prompt) + '&n='+n+'&steps='+steps+'&strength='+strength + '&seed=' + seed;
            $('#output').append('<iframe src="' + iframeHref + '" width="100%" height="1000px"></iframe>');
        }
        $('#generate').click(onClickFn);
        onClickFn();

    </script>
</body>

</html>